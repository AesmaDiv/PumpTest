<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- <meta name="viewport" content="width=210mm, height=297mm, initial-scale=1.0"> -->
    <link rel="stylesheet" href="./style.css">
    <style>
        body {
            width: 210mm;
            height: 295mm;
            background-color: rgb(255,255,255);
            --border-style: 1px solid black;
            /* border: var(--border-style); */
            font-size: small;
            position: relative;
        }
        p {
            margin: 2px;
            font-weight: 600;
        }
        /* ЗАГОЛОВОК */
        header {
            width: 100%;
            height: 3%;
            display: grid;
            grid-template-columns: 37% 26% 37%;
            grid-template-rows: 100%;
            align-items: flex-start;
        }
        #header-pump-type {
            justify-self: stretch;
            text-align: start;
        }
        #header-title {
            height: 100%;
            justify-self: stretch;
            text-align: center;
            vertical-align: middle;
            display: grid;
            grid-template-columns: 20% auto;
            column-gap: 0;
        }
        #header-title-logo {
            height: 100%;
            width: auto;
        }
        #header-title-company {
            display: inline;
            font-weight: 800;
            font-size: 16px;
            text-align: center;
        }
        #header-test-time {
            justify-self: stretch;
            text-align: end;
        }
        /* СОДЕРЖАНИЕ */
        main {
            width: 100%;
            height: auto;
            font-size: smaller;
        }
        #pump-info, #test-info {
            display: grid;
            grid-template-rows: repeat(4, auto);
            grid-template-columns: 20% 30% 20% 30%;
            margin-left: 5%;
            grid-auto-flow: column;
            justify-content: start;
            justify-items: start;
        }
        #test-info {
            grid-template-rows: repeat(8, auto);
        }
        #graph-container {
            width: 100%;
            height: 40%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10px auto;
            background-color: bisque;
        }
        #delta-info {
            display: grid;
            grid-template-rows: repeat(4, auto);
            grid-template-columns: repeat(4, auto);
            grid-auto-flow: column;
        }
        .delta-lft {
            color: blue;
        }
        .delta-pwr {
            color: red;
        }
        .delta-eff {
            color: green;
        }
        #test-table {
            display: grid;
            grid-template-columns: 50px repeat(6, calc((100% - 50px) / 6));
            margin: 5px 0px;
            justify-items: stretch;
            border-bottom: var(--border-style);
            border-right: var(--border-style);
        }
        .test-table{
            border-top: var(--border-style);
            border-left: var(--border-style);
            padding: 0px 5px;
        }
        .test-table.label {
            text-align: center;
        }
        #test-table-bottom {
            width: 100%;
            display: grid;
            grid-auto-flow: column;
            align-items: flex-start;
        }
        .vibr-table {
            margin-left: 2em;
            display: grid;
            grid-template-columns: repeat(2, 100px);
        }
        /* ОСНОВАНИЕ */
        footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            display: grid;
            grid-template-columns: repeat(2, 50%);
            align-items: flex-start;
            grid-auto-flow: column;
            font-size: smaller;
            height: 10em;
        }
        .signatures {
            width: 40%;
            margin-left: 7em;
            display: grid;
            grid-template-columns: repeat(2, auto);
            grid-auto-flow: row;
            row-gap: 4em;
        }
    </style>
   <title>Document</title>
</head>
<body>
    <header>
        <div id="header-pump-type">№ {{ test_info['ID'] }}</div>
        <div id="header-title">
            <img id="header-title-logo" src="./Files/report/logo.png" alt="logo">
            <div id="header-title-company">ЛУКОЙЛ ЭПУ СЕРВИС</div>
        </div>
        <div id="header-test-time">{{ test_info['DateTime'] }}</div>
    </header>
    <main>
        <p>Информация по насосу:</p>
        <div id="pump-info">
            <span class="info-label">Производитель</span>
            <span class="info-label">Типоразмер</span>
            <span class="info-label">Исполнение</span>
            <span class="info-label">Заводской номер</span>


            <span class="info-value">{{type_info.ProducerName}}</span>
            <span class="info-value">{{type_info.Name}}</span>
            <span class="info-value">{{pump_info.GroupName}} / {{pump_info.MaterialName}} / {{pump_info.SizeName}}</span>
            <span class="info-value">{{pump_info.Serial }}</span>
            
            <span class="info-label">Длина корпуса</span>
            <span class="info-label">Кол-во ступеней</span>
            <span class="info-label">Тип соединения</span>
            <span class="info-label"></span>
            
            <span class="info-value">{{pump_info.Length}}</span>
            <span class="info-value">{{pump_info.Stages}}</span>
            <span class="info-value">{{pump_info.ConnectionName}}</span>
            <span class="info-label"></span>
        </div>
        <p>Информация по испытанию:</p>
        <div id="test-info">
            <span class="info-label">Дата теста</span>
            <span class="info-label">Дата сборки</span>
            <span class="info-label">Заказчик</span>
            <span class="info-label">Собственник</span>
            <span class="info-label">Наряд-заказ №</span>
            <span class="info-label">Месторождение</span>
            <span class="info-label">Куст</span>
            <span class="info-label">Скважина</span>
            
            <span class="info-value">{{test_info.DateTime}}</span>
            <span class="info-value">{{test_info.DateAssemblied}}</span>
            <span class="info-value">{{test_info.CustomerName}}</span>
            <span class="info-value">{{test_info.OwnerName}}</span>
            <span class="info-value">{{test_info.OrderNum}}</span>
            <span class="info-value">{{test_info.Location}}</span>
            <span class="info-value">{{test_info.Lease}}</span>
            <span class="info-value">{{test_info.Well}}</span>
            
            <span class="info-label">Суткопробег</span>
            <span class="info-label">Статус секции</span>
            <span class="info-label">Тип секции</span>
            <span class="info-label">Диаметр вала, мм</span>
            <span class="info-label">Вылет вала, мм</span>
            <span class="info-label">Заглубление вала, мм</span>
            <span class="info-label">Биение вала, мм</span>
            <span class="info-label">Момент проворота, Н*м</span>
            
            <span class="info-value">{{test_info.DaysRun}}</span>
            <span class="info-value">{{test_info.SectionStatusName}}</span>
            <span class="info-value">{{test_info.SectionTypeName}}</span>
            <span class="info-value">{{test_info.ShaftDiameter}}</span>
            <span class="info-value">{{test_info.ShaftOut}}</span>
            <span class="info-value">{{test_info.ShaftIn}}</span>
            <span class="info-value">{{test_info.ShaftWobb}}</span>
            <span class="info-value">{{test_info.ShaftMomentum}}</span>
        </div>
        <p>Результаты испытания:</p>
        <div id="graph-container">
            <img id="graph-image" src="./Files/report/graph_image.jpg" alt="graph image">
        </div>
        <div id="delta-info">
            <span class="delta-all title"></span>
            <span class="delta-lft title">Отклонение напора, %:</span>
            <span class="delta-pwr title">Отклонение мощности, %:</span>
            <span class="delta-eff title">Отклонение КПД, %:</span>

            <span class="delta-all">Мин.</span>
            <span class="delta-lft">{{delta_lft[0] | round(2)}}</span>
            <span class="delta-pwr">{{delta_pwr[0] | round(2)}}</span>
            <span class="delta-eff">{{delta_eff[0] | round(2)}}</span>

            <span class="delta-all">Ном.</span>
            <span class="delta-lft">{{delta_lft[1] | round(2)}}</span>
            <span class="delta-pwr">{{delta_pwr[1] | round(2)}}</span>
            <span class="delta-eff">{{delta_eff[1] | round(2)}}</span>

            <span class="delta-all">Макс.</span>
            <span class="delta-lft">{{delta_lft[2] | round(2)}}</span>
            <span class="delta-pwr">{{delta_pwr[2] | round(2)}}</span>
            <span class="delta-eff">{{delta_eff[2] | round(2)}}</span>
        </div>
        <div id="test-table">
            <span class="test-table label">№ точки</span>
            <span class="test-table label">Расход, м3/сут</span>
            <span class="test-table label">Напор / ступ., м</span>
            <span class="test-table label">Мощность / ступ., кВт</span>
            <span class="test-table label">КПД, %</span>
            <!-- <span class="test-table label">Об/мин</span> -->
            <span class="test-table label">Напор, м</span>
            <span class="test-table label">Мощность, кВт</span>
            {% for i in range(test_info.num_points()) %}
                <span class="test-table value">{{i + 1}}</span>
                <span class="test-table value">{{test_info.values_flw[i]|round(1)}}</span>
                <span class="test-table value">{{test_info.values_lft[i]|round(1)}}</span>
                <span class="test-table value">{{test_info.values_pwr[i]|round(3)}}</span>
                <span class="test-table value">{{test_info.values_eff[i]|round(1)}}</span>
                <span class="test-table value">{{(test_info.values_lft[i] * pump_info['Stages'])|round(3)}}</span>
                <span class="test-table value">{{(test_info.values_pwr[i] * pump_info['Stages'])|round(3)}}</span>
            {% endfor %}
        </div>
        <div id="test-table-bottom">
            <span><i>
                * Мощность и напор даны с поправкой на плотность воды (1000 кг/м3).<br>
                * Дебит, напор и мощность нормализированы на 2910 об/мин.<br>
                * Насос испытывался в горизонтальном положении.<br></i>
            </span>
            <div class="vibr-info">
                <p >Замер вибрации:</p>
                <div class="vibr-table">
                    <span>Точка 1:</span>
                    <span>{{test_info.values_vbr[0]}}</span>
                    <span>Точка 2:</span>
                    <span>{{test_info.values_vbr[1]}}</span>
                    <span>Точка 3:</span>
                    <span>{{test_info.values_vbr[2]}}</span>
                </div>
            </div>
        </div>
    </main>
    <footer>
        <div class="comments">
            <p>Примечания:</p>
            <span>
                Должен заметить, что мы продолжаем мониторинг, и должен также заметить,
                что это не первый случай, когда после предостережений, высказанных в том
                числе и членами нашей комиссии, такие компании, как Google, удаляют
                вредоносный контент, который, по сути, является противоправным.
            </span>
        </div>
        <div class="signatures">
            <p>Испытатель:</p>
            <p>_______________________________</p>
            <p>Мастер:</p>
            <p>_______________________________</p>
        </div>
    </footer>
</body>
</html>